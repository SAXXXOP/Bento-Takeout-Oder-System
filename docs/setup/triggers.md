# トリガー設定（必須/任意）

## 目的
運用を止めないために、必要なトリガーを「何を・どこから」設定するかを明文化します。

---

## トリガー一覧（現行実装）

## 1) 必須：フォーム送信
- ハンドラ：`onFormSubmit`
- 種別：フォーム送信時（可能ならフォーム側トリガーで作成）

### 設定方法（推奨：メニューから）
`★予約管理 → 導入時のみ（管理者） → 【トリガー（フォーム送信）】設定`

### 停止
`★予約管理 → 導入時のみ（管理者） → 【トリガー（フォーム送信）】削除`

---

## 2) 任意：日次準備（当日まとめ + 予約札 自動作成）
- ハンドラ：`dailyPrepTrigger`
- 種別：時間主導（毎日）
- 対象日：`今日 + DAILY_PREP_OFFSET_DAYS`
- 曜日：`DAILY_PREP_WEEKDAYS`

### 設定（時刻/オフセット/曜日）
`★予約管理 → 不定期メンテ（管理者） → 【日次準備（自動化）】設定（時刻/オフセット/曜日）`

入力例：
- `hour=7 minute=0 offset=0 weekdays=1-7`
- `hour=21 minute=0 offset=1 weekdays=4-7`

### トリガー再作成（復旧）
`★予約管理 → 不定期メンテ（管理者） → 【日次準備（自動化）】トリガー再作成（復旧）`

### 停止
`★予約管理 → 不定期メンテ（管理者） → 【日次準備（自動化）】トリガー削除（停止）`

---

## 3) 任意：日次バックアップ
- ハンドラ：`backupSpreadsheetDaily`
- 種別：時間主導（毎日）
- 保存先：`BACKUP_FOLDER_ID`

### 設定
`★予約管理 → 不定期メンテ（管理者） → 【バックアップ】日次バックアップ設定（トリガー作成）`

### 停止
`★予約管理 → 不定期メンテ（管理者） → 【バックアップ】日次バックアップ停止（トリガー削除）`

---

## 4) 任意：運用通知（1時間まとめ）
- ハンドラ：`opsNotifyHourlyTrigger`
- 種別：時間主導（毎時間）
- 宛先：`LATE_SUBMISSION_NOTIFY_TO`

### 設定
`★予約管理 → 不定期メンテ（管理者） → 【運用通知（1時間まとめ）】トリガー作成（1時間ごと）`

### 停止
`★予約管理 → 不定期メンテ（管理者） → 【運用通知（1時間まとめ）】トリガー削除`

---

## よくある注意点
- トリガーが重複すると二重記録/二重通知の原因になります  
  → メニュー操作は「既存トリガー削除→作成」を内部で行います
- UI を使う関数はトリガー実行できません（`SpreadsheetApp.getUi()` が落ちます）  
  → トリガー起動先は専用関数（`dailyPrepTrigger` 等）を使ってください
