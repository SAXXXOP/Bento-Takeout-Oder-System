# 初期セットアップ（テンプレコピー〜動作確認）

## 目的
フォーム送信 → `注文一覧` 記録（予約No発行 / ステータス付与 / 自動返信）までを、最短で動かします。

---

## 前提（このシステムの特徴）
- フォーム送信を起点に `onFormSubmit(e)` が動き、`注文一覧` へ保存します。
- 必須タブ（テンプレ同梱前提）：
  - 注文一覧 / メニューマスタ / 当日まとめ / 予約札 / ★要確認一覧 / 休業日設定 / ログ
- ステータス運用（B案）
  - 有効：`""`（空）
  - 無効：`"無効"`
  - 要確認：`"★要確認"`

---

## 手順

### 1) テンプレのスプレッドシートをコピー
1. テンプレのスプレッドシートを開く
2. 「ファイル」→「コピーを作成」
3. 店舗用の名前で作成（例：`弁当予約管理_店舗名`）

---

### 2) フォームとスプレッドシートの紐づけ確認
- スプレッドシートがフォームに紐づいている必要があります（`installFormSubmitTrigger` がここを確認します）。
- ずれている場合：フォーム側「回答」→「スプレッドシートにリンク」で、このシートに紐づけ直します。

---

### 3) 初回承認（権限）
1. スプレッドシートを再読み込み（`onOpen` でメニューが出る）
2. 必要なら Apps Script を開き、任意の関数を実行して承認を完了

---

### 4) Script Properties を設定（必要な分だけ）
最低限の導入では「必須」だけでOKです。

- 必須（現行実装の validate 基準）
  - `LINE_TOKEN`
  - `WEBHOOK_KEY`
- 推奨（ログ肥大化防止）
  - `LOG_LEVEL`
  - `LOG_MAX_ROWS`
- 任意（使う場合だけ）
  - バックアップ：`BACKUP_FOLDER_ID`
  - 日次準備（自動化）：`DAILY_PREP_*`
  - 締切後送信通知：`LATE_SUBMISSION_NOTIFY_*`
  - 管理者判定：`ADMIN_EMAILS`

詳しくは：[`setup/properties.md`](properties.md)

---

### 5) フォーム送信トリガー（必須）
スプレッドシート上のメニューから設定できます。

- メニュー：`★予約管理 → 導入時のみ（管理者） → 【トリガー（フォーム送信）】設定`
- 設定されるハンドラ：`onFormSubmit`

---

### 6) テスト送信（動作確認）
1. フォームからテスト送信（1件）
2. `注文一覧` に1行追加される
3. `ログ` タブに記録が残る
4. `★要確認一覧` が（必要なら）更新される

---

## うまくいかない時
最初に見る場所：
- `ログ` タブ
- Apps Script の「実行」→実行履歴

参照：[`troubleshooting/logs.md`](../troubleshooting/logs.md)
