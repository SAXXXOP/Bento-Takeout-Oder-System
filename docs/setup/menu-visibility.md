# メニュー表示制御（管理者 / 閲覧者）

## 目的
普段使わない「管理者向けメニュー」を隠して、誤操作を減らします。

---

## 仕組み（最新版）
メニュー表示は **“管理者/閲覧者”** で切り替えます。

- 管理者：スプレッドシートの **オーナー** + `ADMIN_EMAILS`（任意）
- 閲覧者：上記以外

> 補足：環境によっては `Session.getActiveUser().getEmail()` が空になり、メールで判定できません。  
> その場合だけ互換のため `MENU_SHOW_ADVANCED`（全員に適用）をフォールバックに使います。

---

## 使う Script Properties

### `ADMIN_EMAILS`（推奨）
- カンマ区切りで管理者メールを指定  
  例：`owner@example.com, staff@example.com`
- メール判定できない環境で **全員に管理者メニューを出したい** 場合は、`*` または `ALL` を入れる  
  例：`*`

### `MENU_SHOW_ADVANCED`（互換・緊急用）
- `1/true/yes`：全員に管理者メニューを表示
- `0/false/no`：非表示（既定）

---

## うまくいかない時（判定の見える化）
`★予約管理 → 初期設定/復旧 → 権限チェック（管理者/閲覧者）` を実行すると、
「管理者/閲覧者の判定」や `ADMIN_EMAILS` の読み取り結果が表示されます。

- メニューが消えた/戻らない：  
  `★予約管理 → 初期設定/復旧 → 🔄 メニューを再表示（設定再読込）`
